<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard - Local Gigs</title>
    <link rel="stylesheet" href="css/style.css" />
</head>

<body>
    <header class="header">
        <div class="header-content">
            <a href="dashboard.html" class="logo">Local Gigs</a>
            <nav>
                <ul class="nav-menu">
                    <li><a href="dashboard.html">Dashboard</a></li>
                    <li><a href="events.html">Events</a></li>
                    <li><a href="venues.html">Venues</a></li>
                    <li><a href="profile.html">Profile</a></li>
                    <li>
                        <button class="btn logout-btn" id="logout-button">
                                Logout
                            </button>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="dashboard">
        <div class="container">
            <div class="dashboard-header">
                <h1>
                    Welcome back,
                    <span id="user-display-name">Music Lover</span>!
                </h1>
                <p>
                    Discover amazing local music events with our refreshed modern interface
                </p>
            </div>

            <!-- Quick Actions -->
            <div class="card">
                <h2>Quick Actions</h2>
                <div style="
                            display: flex;
                            gap: 1rem;
                            justify-content: center;
                            flex-wrap: wrap;
                        ">
                    <a href="create-event.html" id="new-event-button" class="btn">
                            Create Event
                        </a>
                    <a href="create-venue.html" id="new-venue-button" class="btn btn-secondary">
                            üè¢ Add New Venue
                        </a>
                    <button id="findEventsBtn" class="btn btn-secondary">
                            Find Events Near Me
                        </button>
                </div>
            </div>

            <!-- AWS Test Results -->
            <div class="card" id="aws-test-results" style="display: none">
                <h2>AWS Services Status</h2>
                <div id="aws-test-content" style="
                            font-family: monospace;
                            background: var(--bg-secondary);
                            padding: 1rem;
                            border-radius: var(--radius-md);
                            margin-top: 1rem;
                        ">
                    <div id="test-output">Ready to test...</div>
                </div>
                <div style="margin-top: 1rem">
                    <button id="hide-test-results" class="btn btn-secondary btn-sm">
                            Hide Results
                        </button>
                </div>
            </div>

            <!-- Map Container -->
            <div class="card">
                <h2>Events Map</h2>
                <div class="map-container">
                    <div id="map-container">
                        <div id="map-status" style="
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    height: 100%;
                                    color: var(--text-muted);
                                    flex-direction: column;
                                    gap: 1rem;
                                ">
                            <p>Loading interactive map...</p>
                            <div id="map-credentials-status" style="
                                        font-size: 0.875rem;
                                        color: var(--text-muted);
                                    "></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Events Grid -->
            <div class="dashboard-grid">
                <!-- Upcoming Events -->
                <div class="card">
                    <div style="
                                display: flex;
                                justify-content: space-between;
                                align-items: center;
                                margin-bottom: 1rem;
                            ">
                        <h2>Upcoming Events</h2>
                        <a href="events.html" class="btn btn-secondary">View All</a
                            >
                        </div>
                        <div id="event-list-container">
                            <div
                                class="loading"
                                style="padding: 2rem; text-align: center"
                            >
                                <div class="spinner"></div>
                                <p>Loading events...</p>
                            </div>
                        </div>
                    </div>

                    <!-- Recommended Events -->
                    <div class="card">
                        <div
                            style="
                                display: flex;
                                justify-content: space-between;
                                align-items: center;
                                margin-bottom: 1rem;
                            "
                        >
                            <h2>Recommended for You</h2>
                            <span id="user-genre" class="genre-tag"></span>
                        </div>
                        <div id="recommended-events">
                            <div
                                class="loading"
                                style="padding: 2rem; text-align: center"
                            >
                                <div class="spinner"></div>
                                <p>Loading recommendations...</p>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Venues -->
                    <div class="card">
                        <div
                            style="
                                display: flex;
                                justify-content: space-between;
                                align-items: center;
                                margin-bottom: 1rem;
                            "
                        >
                            <h2>Popular Venues</h2>
                            <a href="venues.html" class="btn btn-secondary"
                                >View All</a
                            >
                        </div>
                        <div id="popular-venues">
                            <div
                                class="loading"
                                style="padding: 2rem; text-align: center"
                            >
                                <div class="spinner"></div>
                                <p>Loading venues...</p>
                            </div>
                        </div>
                    </div>

                    <!-- User Stats -->
                    <div class="card">
                        <h2>Your Activity</h2>
                        <div
                            class="stats-grid"
                            style="
                                display: grid;
                                grid-template-columns: 1fr 1fr;
                                gap: 1rem;
                                margin-top: 1rem;
                            "
                        >
                            <div class="stat-item text-center">
                                <div class="stat-number" id="events-attended">
                                    0
                                </div>
                                <div class="stat-label">Events Attended</div>
                            </div>
                            <div class="stat-item text-center">
                                <div class="stat-number" id="events-created">
                                    0
                                </div>
                                <div class="stat-label">Events Created</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <script src="js/config.js"></script>
        <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1691.0.min.js"></script>
        <script src="js/utils.js"></script>
        <script src="js/router.js"></script>
        <script src="js/auth.js"></script>
        <script src="js/map.js"></script>
        <script src="js/event-pins.js"></script>
        <script src="js/dashboard.js"></script>

        <script>
            // Initialize navigation fix
            Utils.initializeNavigation();

            document.addEventListener('DOMContentLoaded', function() {
                // Initialize Auth module first
                Auth.init();

                // Wait for Auth to complete initialization before starting Dashboard
                setTimeout(() => {
                    // Only initialize Dashboard if user is authenticated
                    if (Utils.isAuthenticated()) {
                        Dashboard.init();
                    }
                }, 200);

                // Fix navigation links
                document.querySelectorAll('a[href$=".html"]').forEach(link => {
                    link.addEventListener('click', function(e) {
                        const href = this.getAttribute('href');
                        if (href && !href.startsWith('http') && href.endsWith('.html')) {
                            e.preventDefault();
                            console.log('Navigating to:', href);
                            window.location.href = href;
                        }
                    });
                });
            });
        </script>
    </body>
</html>
</text>