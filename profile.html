<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Profile - Local Gigs</title>
        <link rel="stylesheet" href="css/style.css" />
    </head>
    <body>
        <header class="header">
            <div class="header-content">
                <a href="dashboard.html" class="logo">Local Gigs</a>
                <nav>
                    <ul class="nav-menu">
                        <li><a href="dashboard.html">Dashboard</a></li>
                        <li><a href="events.html">Events</a></li>
                        <li><a href="venues.html">Venues</a></li>
                        <li>
                            <a href="profile.html">Profile</a>
                        </li>
                        <li>
                            <button class="btn logout-btn" id="logout-button">
                                Logout
                            </button>
                        </li>
                    </ul>
                </nav>
            </div>
        </header>

        <main class="dashboard">
            <div class="container">
                <div class="dashboard-header">
                    <h1>My Profile</h1>
                    <p>Manage your account and preferences</p>
                </div>

                <!-- Profile Header with Picture -->
                <div class="profile-header">
                    <div class="profile-picture-container">
                        <img
                            id="currentProfilePicture"
                            class="profile-avatar"
                            style="display: none"
                            alt="Profile picture"
                        />
                        <div
                            id="profilePicturePlaceholder"
                            class="profile-picture-placeholder profile-avatar"
                        >
                            <span id="profileInitials">ðŸ‘¤</span>
                        </div>
                        <button
                            class="btn btn-outline btn-sm edit-picture-btn"
                            id="editPictureBtn"
                        >
                            ðŸ“· Change Photo
                        </button>
                    </div>
                    <div class="profile-info">
                        <h1 id="profileDisplayName">Loading...</h1>
                        <p id="profileEmail">Loading...</p>
                        <div class="profile-stats">
                            <div class="profile-stat">
                                <div
                                    class="profile-stat-number"
                                    id="profileEventsCount"
                                >
                                    0
                                </div>
                                <div class="profile-stat-label">
                                    Events Created
                                </div>
                            </div>
                            <div class="profile-stat">
                                <div
                                    class="profile-stat-number"
                                    id="profileGenre"
                                >
                                    -
                                </div>
                                <div class="profile-stat-label">
                                    Favorite Genre
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <!-- Profile Information -->
                    <div class="card">
                        <div
                            style="
                                display: flex;
                                justify-content: space-between;
                                align-items: center;
                                margin-bottom: 1rem;
                            "
                        >
                            <h2>Profile Information</h2>
                            <button
                                id="edit-profile-btn"
                                class="btn btn-secondary"
                            >
                                Edit
                            </button>
                        </div>

                        <div
                            id="profile-display"
                            style="
                                display: flex;
                                gap: 2rem;
                                align-items: flex-start;
                            "
                        >
                            <div style="text-align: center">
                                <img
                                    id="profile-picture"
                                    src="/api/placeholder/120/120"
                                    alt="Profile Picture"
                                    style="
                                        width: 120px;
                                        height: 120px;
                                        border-radius: 50%;
                                        object-fit: cover;
                                        border: 3px solid #dee2e6;
                                    "
                                />
                                <button
                                    id="change-picture-btn"
                                    class="btn btn-secondary"
                                    style="
                                        margin-top: 0.5rem;
                                        font-size: 0.8rem;
                                    "
                                >
                                    Change Photo
                                </button>
                            </div>
                            <div style="flex: 1">
                                <div style="margin-bottom: 1rem">
                                    <strong>Name:</strong>
                                    <span id="display-name">Loading...</span>
                                </div>
                                <div style="margin-bottom: 1rem">
                                    <strong>Email:</strong>
                                    <span id="display-email">Loading...</span>
                                </div>
                                <div style="margin-bottom: 1rem">
                                    <strong>Bio:</strong>
                                    <span
                                        id="display-bio"
                                        style="color: #666; font-style: italic"
                                        >No bio added yet</span
                                    >
                                </div>
                                <div style="margin-bottom: 1rem">
                                    <strong>Member Since:</strong>
                                    <span id="display-member-since"
                                        >Loading...</span
                                    >
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Music Preferences -->
                    <div class="card">
                        <div
                            style="
                                display: flex;
                                justify-content: space-between;
                                align-items: center;
                                margin-bottom: 1rem;
                            "
                        >
                            <h2>Music Preferences</h2>
                            <button
                                id="edit-preferences-btn"
                                class="btn btn-secondary"
                            >
                                Edit
                            </button>
                        </div>

                        <div id="preferences-display">
                            <div style="margin-bottom: 1rem">
                                <strong>Favorite Genres:</strong>
                                <div
                                    id="favorite-genres"
                                    style="margin-top: 0.5rem"
                                >
                                    <span class="genre-tag">Loading...</span>
                                </div>
                            </div>
                            <div style="margin-bottom: 1rem">
                                <strong>Notifications:</strong>
                                <span id="notifications-status"
                                    >Loading...</span
                                >
                            </div>
                            <div style="margin-bottom: 1rem">
                                <strong>Event Reminders:</strong>
                                <span id="reminders-status">Loading...</span>
                            </div>
                        </div>
                    </div>

                    <!-- Activity Summary -->
                    <div class="card">
                        <h2>Activity Summary</h2>
                        <div
                            class="stats-grid"
                            style="
                                display: grid;
                                grid-template-columns: repeat(
                                    auto-fit,
                                    minmax(150px, 1fr)
                                );
                                gap: 1rem;
                                margin-top: 1rem;
                            "
                        >
                            <div class="stat-item text-center">
                                <div
                                    class="stat-number"
                                    id="events-created-count"
                                >
                                    0
                                </div>
                                <div class="stat-label">Events Created</div>
                            </div>
                            <div class="stat-item text-center">
                                <div
                                    class="stat-number"
                                    id="events-joined-count"
                                >
                                    0
                                </div>
                                <div class="stat-label">Events Joined</div>
                            </div>
                            <div class="stat-item text-center">
                                <div
                                    class="stat-number"
                                    id="venues-added-count"
                                >
                                    0
                                </div>
                                <div class="stat-label">Venues Added</div>
                            </div>
                            <div class="stat-item text-center">
                                <div class="stat-number" id="days-active">
                                    0
                                </div>
                                <div class="stat-label">Days Active</div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="card">
                        <h2>Recent Activity</h2>
                        <div id="recent-activity">
                            <div class="loading-placeholder">
                                <p>Loading recent activity...</p>
                            </div>
                        </div>
                    </div>

                    <!-- Account Settings -->
                    <div class="card">
                        <h2>Account Settings</h2>
                        <div
                            style="
                                display: flex;
                                flex-direction: column;
                                gap: 1rem;
                            "
                        >
                            <button
                                id="change-password-btn"
                                class="btn btn-secondary"
                            >
                                Change Password
                            </button>
                            <button
                                id="privacy-settings-btn"
                                class="btn btn-secondary"
                            >
                                Privacy Settings
                            </button>
                            <button
                                id="export-data-btn"
                                class="btn btn-secondary"
                            >
                                Export My Data
                            </button>
                            <button
                                id="delete-account-btn"
                                class="btn"
                                style="background: #dc3545; color: white"
                            >
                                Delete Account
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Edit Profile Modal -->
        <div id="edit-profile-modal" class="modal">
            <div class="modal-content">
                <span class="close" id="close-profile-modal">&times;</span>
                <h2>Edit Profile</h2>
                <div id="profile-modal-messages"></div>
                <form id="edit-profile-form">
                    <div class="form-group">
                        <label for="profileName">Full Name *</label>
                        <input
                            type="text"
                            id="profileName"
                            name="name"
                            class="form-control"
                            required
                            placeholder="Enter your full name"
                            maxlength="100"
                        />
                    </div>

                    <div class="form-group">
                        <label for="profileBio">Bio</label>
                        <textarea
                            id="profileBio"
                            name="bio"
                            class="form-control"
                            rows="4"
                            placeholder="Tell us about yourself..."
                            maxlength="500"
                        ></textarea>
                    </div>

                    <div class="form-group">
                        <label for="profileLocation">Location</label>
                        <input
                            type="text"
                            id="profileLocation"
                            name="location"
                            class="form-control"
                            placeholder="City, Country"
                            maxlength="100"
                        />
                    </div>

                    <div class="form-group">
                        <label for="profileWebsite">Website</label>
                        <input
                            type="url"
                            id="profileWebsite"
                            name="website"
                            class="form-control"
                            placeholder="https://your-website.com"
                        />
                    </div>

                    <div class="form-group">
                        <button type="submit" class="btn" style="width: 100%">
                            Save Changes
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Edit Preferences Modal -->
        <div id="edit-preferences-modal" class="modal">
            <div class="modal-content">
                <span class="close" id="close-preferences-modal">&times;</span>
                <h2>Music Preferences</h2>
                <div id="preferences-modal-messages"></div>
                <form id="edit-preferences-form">
                    <div class="form-group">
                        <label>Favorite Genres (select up to 3)</label>
                        <div
                            class="genre-grid"
                            style="
                                display: grid;
                                grid-template-columns: repeat(
                                    auto-fit,
                                    minmax(150px, 1fr)
                                );
                                gap: 0.5rem;
                                margin-top: 0.5rem;
                            "
                        >
                            <label class="genre-option">
                                <input
                                    type="checkbox"
                                    name="genres"
                                    value="rock"
                                />
                                <span>Rock</span>
                            </label>
                            <label class="genre-option">
                                <input
                                    type="checkbox"
                                    name="genres"
                                    value="pop"
                                />
                                <span>Pop</span>
                            </label>
                            <label class="genre-option">
                                <input
                                    type="checkbox"
                                    name="genres"
                                    value="jazz"
                                />
                                <span>Jazz</span>
                            </label>
                            <label class="genre-option">
                                <input
                                    type="checkbox"
                                    name="genres"
                                    value="electronic"
                                />
                                <span>Electronic</span>
                            </label>
                            <label class="genre-option">
                                <input
                                    type="checkbox"
                                    name="genres"
                                    value="hiphop"
                                />
                                <span>Hip-Hop</span>
                            </label>
                            <label class="genre-option">
                                <input
                                    type="checkbox"
                                    name="genres"
                                    value="indie"
                                />
                                <span>Indie</span>
                            </label>
                            <label class="genre-option">
                                <input
                                    type="checkbox"
                                    name="genres"
                                    value="metal"
                                />
                                <span>Metal</span>
                            </label>
                            <label class="genre-option">
                                <input
                                    type="checkbox"
                                    name="genres"
                                    value="country"
                                />
                                <span>Country</span>
                            </label>
                            <label class="genre-option">
                                <input
                                    type="checkbox"
                                    name="genres"
                                    value="reggae"
                                />
                                <span>Reggae</span>
                            </label>
                            <label class="genre-option">
                                <input
                                    type="checkbox"
                                    name="genres"
                                    value="classical"
                                />
                                <span>Classical</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="toggle-group">
                            <div class="toggle-content">
                                <div class="toggle-title">
                                    Email Notifications
                                </div>
                                <div class="toggle-description">
                                    Receive email updates about new events
                                </div>
                            </div>
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="emailNotifications"
                                    name="emailNotifications"
                                />
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="toggle-group">
                            <div class="toggle-content">
                                <div class="toggle-title">Event Reminders</div>
                                <div class="toggle-description">
                                    Get reminders before events you've joined
                                </div>
                            </div>
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="eventReminders"
                                    name="eventReminders"
                                />
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="toggle-group">
                            <div class="toggle-content">
                                <div class="toggle-title">
                                    Location-based Suggestions
                                </div>
                                <div class="toggle-description">
                                    Show events near your location
                                </div>
                            </div>
                            <label class="toggle-switch">
                                <input
                                    type="checkbox"
                                    id="locationSuggestions"
                                    name="locationSuggestions"
                                />
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <button type="submit" class="btn" style="width: 100%">
                            Save Preferences
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Change Password Modal -->
        <div id="change-password-modal" class="modal">
            <div class="modal-content">
                <span class="close" id="close-password-modal">&times;</span>
                <h2>Change Password</h2>
                <div id="password-modal-messages"></div>
                <form id="change-password-form">
                    <div class="form-group">
                        <label for="currentPassword">Current Password *</label>
                        <input
                            type="password"
                            id="currentPassword"
                            name="currentPassword"
                            class="form-control"
                            required
                        />
                    </div>

                    <div class="form-group">
                        <label for="newPassword">New Password *</label>
                        <input
                            type="password"
                            id="newPassword"
                            name="newPassword"
                            class="form-control"
                            required
                            minlength="8"
                        />
                        <div class="form-text">
                            Password must be at least 8 characters long
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="confirmPassword"
                            >Confirm New Password *</label
                        >
                        <input
                            type="password"
                            id="confirmPassword"
                            name="confirmPassword"
                            class="form-control"
                            required
                        />
                    </div>

                    <div class="form-group">
                        <button type="submit" class="btn" style="width: 100%">
                            Change Password
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Profile Picture Upload Modal -->
        <div id="profile-picture-modal" class="modal">
            <div class="modal-content">
                <span class="close" id="close-picture-modal">&times;</span>
                <h2>Change Profile Picture</h2>
                <div id="picture-modal-messages"></div>
                <form id="profile-picture-form">
                    <div class="form-group">
                        <label for="profilePictureFile"
                            >Choose Profile Picture</label
                        >
                        <input
                            type="file"
                            id="profilePictureFile"
                            name="profilePicture"
                            class="form-control"
                            accept="image/*"
                            required
                        />
                        <div class="form-text">
                            Recommended: Square image, max 5MB
                        </div>
                    </div>

                    <div class="form-group">
                        <div
                            id="image-preview"
                            style="
                                text-align: center;
                                margin: 1rem 0;
                                display: none;
                            "
                        >
                            <img
                                id="preview-image"
                                src=""
                                alt="Preview"
                                style="
                                    max-width: 200px;
                                    max-height: 200px;
                                    border-radius: 50%;
                                    border: 2px solid #dee2e6;
                                "
                            />
                        </div>
                    </div>

                    <div class="form-group">
                        <button type="submit" class="btn" style="width: 100%">
                            Upload Picture
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <script src="js/config.js"></script>
        <script src="js/utils.js"></script>
        <script src="js/auth.js"></script>
        <script src="js/profile.js"></script>

        <script>
            // Initialize navigation fix
            Utils.initializeNavigation();

            // Profile management
            const ProfileManager = {
                currentUser: null,

                init: async function () {
                    // Check authentication
                    if (!Utils.requireAuth()) {
                        return;
                    }

                    this.currentUser = Utils.getUserFromToken();
                    if (!this.currentUser) {
                        Utils.logout();
                        return;
                    }

                    await this.loadProfileData();
                    this.setupEventListeners();
                },

                loadProfileData: async function () {
                    try {
                        // Load user profile from backend
                        const url = CONFIG.buildApiUrl(
                            CONFIG.API.ENDPOINTS.USERS,
                            this.currentUser.sub,
                        );
                        const userProfile = await Utils.apiCall(url, {
                            method: "GET",
                            headers: CONFIG.getAuthHeaders(),
                        });

                        this.displayProfile(userProfile);
                    } catch (error) {
                        console.error("Failed to load profile:", error);
                        // Fall back to token data
                        this.displayProfile({
                            name: this.currentUser.email.split("@")[0],
                            email: this.currentUser.email,
                            preferences: { genre: "Unknown" },
                        });
                    }
                },

                displayProfile: function (profile) {
                    // Update profile display
                    const displayName =
                        document.getElementById("profileDisplayName");
                    const email = document.getElementById("profileEmail");
                    const genre = document.getElementById("profileGenre");
                    const initials = document.getElementById("profileInitials");

                    if (displayName)
                        displayName.textContent = profile.name || "User";
                    if (email)
                        email.textContent =
                            profile.email || this.currentUser.email;
                    if (genre)
                        genre.textContent =
                            profile.preferences?.genre || "Unknown";

                    // Set profile initials
                    if (initials && profile.name) {
                        initials.textContent = profile.name
                            .charAt(0)
                            .toUpperCase();
                    }

                    // Display profile picture if available
                    if (profile.profilePicture) {
                        this.displayProfilePicture(profile.profilePicture);
                    }
                },

                displayProfilePicture: function (imageUrl) {
                    const currentPicture = document.getElementById(
                        "currentProfilePicture",
                    );
                    const placeholder = document.getElementById(
                        "profilePicturePlaceholder",
                    );

                    if (currentPicture && placeholder) {
                        // Handle S3 URLs
                        let fullUrl = imageUrl;
                        if (!imageUrl.startsWith("http")) {
                            fullUrl = `https://local-gigs-static.s3.us-east-1.amazonaws.com/${imageUrl}`;
                        }

                        currentPicture.src = fullUrl;
                        currentPicture.style.display = "block";
                        placeholder.style.display = "none";

                        // Handle image load errors
                        currentPicture.onerror = function () {
                            this.style.display = "none";
                            placeholder.style.display = "block";
                        };
                    }
                },

                setupEventListeners: function () {
                    // Edit picture button
                    const editPictureBtn =
                        document.getElementById("editPictureBtn");
                    const pictureModal = document.getElementById(
                        "profile-picture-modal",
                    );
                    const closePictureModal = document.getElementById(
                        "close-picture-modal",
                    );
                    const pictureForm = document.getElementById(
                        "profile-picture-form",
                    );
                    const pictureFileInput =
                        document.getElementById("profilePictureFile");

                    if (editPictureBtn && pictureModal) {
                        editPictureBtn.addEventListener("click", () => {
                            pictureModal.style.display = "block";
                        });
                    }

                    if (closePictureModal && pictureModal) {
                        closePictureModal.addEventListener("click", () => {
                            pictureModal.style.display = "none";
                        });
                    }

                    // Picture file input preview
                    if (pictureFileInput) {
                        pictureFileInput.addEventListener("change", (e) => {
                            const file = e.target.files[0];
                            if (file) {
                                try {
                                    Utils.s3.validateImageFile(file);
                                    this.previewImage(file);
                                } catch (error) {
                                    alert(error.message);
                                    pictureFileInput.value = "";
                                }
                            }
                        });
                    }

                    // Picture form submission
                    if (pictureForm) {
                        pictureForm.addEventListener("submit", (e) => {
                            e.preventDefault();
                            this.handlePictureUpload(e);
                        });
                    }

                    // Close modal when clicking outside
                    window.addEventListener("click", (e) => {
                        if (e.target === pictureModal) {
                            pictureModal.style.display = "none";
                        }
                    });

                    // Logout button
                    const logoutBtn = document.getElementById("logout-button");
                    if (logoutBtn) {
                        logoutBtn.addEventListener("click", (e) => {
                            e.preventDefault();
                            Utils.logout();
                        });
                    }
                },

                previewImage: function (file) {
                    const preview = document.getElementById("image-preview");
                    const previewImg = document.getElementById("preview-image");

                    if (preview && previewImg) {
                        const reader = new FileReader();
                        reader.onload = function (e) {
                            previewImg.src = e.target.result;
                            preview.style.display = "block";
                        };
                        reader.readAsDataURL(file);
                    }
                },

                handlePictureUpload: async function (e) {
                    const form = e.target;
                    const submitBtn = form.querySelector(
                        'button[type="submit"]',
                    );
                    const messagesDiv = document.getElementById(
                        "picture-modal-messages",
                    );
                    const fileInput =
                        document.getElementById("profilePictureFile");

                    try {
                        Utils.showLoading(submitBtn, "Uploading...");

                        const file = fileInput.files[0];
                        if (!file) {
                            throw new Error("Please select a file");
                        }

                        // Upload to S3
                        const imageUrl = await Utils.s3.uploadProfilePicture(
                            file,
                            this.currentUser.sub,
                        );

                        // Update user profile with new image URL
                        const profileData = {
                            userID: this.currentUser.sub,
                            profilePicture: imageUrl,
                        };

                        const url = CONFIG.buildApiUrl(
                            CONFIG.API.ENDPOINTS.USERS,
                            this.currentUser.sub,
                        );
                        await Utils.apiCall(url, {
                            method: "PUT",
                            headers: CONFIG.getAuthHeaders(),
                            body: JSON.stringify(profileData),
                        });

                        // Update display
                        this.displayProfilePicture(imageUrl);

                        Utils.showSuccess(
                            "Profile picture updated successfully!",
                            messagesDiv.id,
                        );

                        // Close modal after delay
                        setTimeout(() => {
                            document.getElementById(
                                "profile-picture-modal",
                            ).style.display = "none";
                        }, 2000);
                    } catch (error) {
                        console.error("Picture upload failed:", error);
                        Utils.showError(
                            error.message || "Failed to update profile picture",
                            messagesDiv.id,
                        );
                    } finally {
                        Utils.hideLoading(submitBtn, "Upload Picture");
                    }
                },
            };

            // Initialize when DOM is loaded
            document.addEventListener("DOMContentLoaded", function () {
                ProfileManager.init();
            });
        </script>

        <style>
            .genre-tag {
                background: #f8f9fa;
                color: #333;
                padding: 0.25rem 0.75rem;
                border-radius: 15px;
                font-size: 0.8rem;
                font-weight: 500;
                margin-right: 0.5rem;
                margin-bottom: 0.5rem;
                display: inline-block;
            }

            .loading-placeholder {
                text-align: center;
                padding: 2rem;
                color: #666;
            }

            .stat-number {
                font-size: 2rem;
                font-weight: bold;
                color: #333;
                margin-bottom: 0.5rem;
            }

            .stat-label {
                color: #666;
                font-size: 0.9rem;
            }

            .activity-item {
                padding: 1rem;
                border-bottom: 1px solid #eee;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .activity-item:last-child {
                border-bottom: none;
            }

            .activity-icon {
                width: 40px;
                height: 40px;
                border-radius: 50%;
                background: #f8f9fa;
                display: flex;
                align-items: center;
                justify-content: center;
                margin-right: 1rem;
                font-size: 1.2rem;
            }

            .activity-content {
                flex: 1;
            }

            .activity-title {
                font-weight: 600;
                margin-bottom: 0.25rem;
            }

            .activity-time {
                color: #666;
                font-size: 0.9rem;
            }

            .genre-option {
                display: flex;
                align-items: center;
                padding: 0.75rem;
                border: 1px solid #dee2e6;
                border-radius: 8px;
                cursor: pointer;
                transition: var(--transition);
            }

            .genre-option:hover {
                border-color: #333;
                background: #f8f9fa;
            }

            .genre-option.selected {
                border-color: #333;
                background: #333;
                color: white;
            }

            .genre-option input[type="checkbox"] {
                margin-right: 0.5rem;
            }

            @media (max-width: 768px) {
                #profile-display {
                    flex-direction: column;
                    text-align: center;
                }

                .dashboard-grid {
                    grid-template-columns: 1fr;
                }

                .stats-grid {
                    grid-template-columns: repeat(2, 1fr);
                }

                .genre-grid {
                    grid-template-columns: 1fr;
                }

                .activity-item {
                    flex-direction: column;
                    align-items: flex-start;
                    text-align: left;
                }

                .activity-icon {
                    margin-bottom: 0.5rem;
                    margin-right: 0;
                }
            }
        </style>

        <script>
            // Initialize modules when DOM is loaded
            document.addEventListener("DOMContentLoaded", function () {
                // Initialize Auth module
                Auth.init();

                // Initialize Profile module if it exists
                if (typeof ProfilePage !== "undefined") {
                    ProfilePage.init();
                }

                // Fix navigation links
                document
                    .querySelectorAll('a[href$=".html"]')
                    .forEach((link) => {
                        link.addEventListener("click", function (e) {
                            const href = this.getAttribute("href");
                            if (
                                href &&
                                !href.startsWith("http") &&
                                href.endsWith(".html")
                            ) {
                                e.preventDefault();
                                console.log("Navigating to:", href);
                                window.location.href = href;
                            }
                        });
                    });
            });
        </script>
    </body>
</html>
